---
title: "sangeranalyzeR"
author: "Paul salib"
date: "2022-12-06"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(sangeranalyseR)
```


```{r}
my_aligned_contigs <- SangerAlignment(ABIF_Directory      = "~/Desktop/sfmock",
                                      processMethod       = "REGEX",
                                      REGEX_SuffixForward = "_[0-9]*_F.ab1$",
                                      REGEX_SuffixReverse = "_[0-9]*_R.ab1$")
```

```{r}
launchApp(my_aligned_contigs) ## an intervative app to view your contig sequences, chromatograms, and trimming parameters 
```


```{r}
writeFasta(my_aligned_contigs, outputDir = "~/Desktop/sfmock")
```


```{r}
generateReport(my_aligned_contigs)
```

# advanced sangeranalyseR

## SANGER READ 
```{r}
inputFilesPath <- "~/Desktop/sfmock" 
sfseq <- file.path(inputFilesPath, 
                   pattern=".ab1",
                   full.names=TRUE)
print(sfseq)
```

```{r}
sangerReadF <- SangerRead(readFeature           = "Forward Read",
                          readFileName          = sfseq,
                          geneticCode           = GENETIC_CODE,
                          TrimmingMethod        = "M1",
                          M1TrimmingCutoff      = 0.0001,
                          M2CutoffQualityScore  = NULL,
                          M2SlidingWindowSize   = NULL,
                          baseNumPerRow         = 100,
                          heightPerRow          = 200,
                          signalRatioCutoff     = 0.33,
                          showTrimmed           = TRUE)
```

## SANGER CONTIG 
```{r}
rawDataDir <- "~/Desktop/sfmock" 
parentDir <- file.path(rawDataDir, "sf")
```

```{r}
my_sangerContig <- SangerContig(inputSource           = "ABIF",
                                processMethod         = "REGEX",
                                ABIF_Directory        = parentDir,
                                contigName            = "FC",
                                REGEX_SuffixForward   = "_[0-9]*_F.ab1$",
                                REGEX_SuffixReverse   = "_[0-9]*_R.ab1$",
                                TrimmingMethod        = "M1",
                                M1TrimmingCutoff      = 0.0001,
                                M2CutoffQualityScore  = NULL,
                                M2SlidingWindowSize   = NULL,
                                baseNumPerRow         = 100,
                                heightPerRow          = 200,
                                signalRatioCutoff     = 0.33,
                                showTrimmed           = TRUE,
                                refAminoAcidSeq       = "SRQWLFSTNHKDIGTLYFIFGAWAGMVGTSLSILIRAELGHPGALIGDDQIYNVIVTAHAFIMIFFMVMPIMIGGFGNWLVPLMLGAPDMAFPRMNNMSFWLLPPALSLLLVSSMVENGAGTGWTVYPPLSAGIAHGGASVDLAIFSLHLAGISSILGAVNFITTVINMRSTGISLDRMPLFVWSVVITALLLLLSLPVLAGAITMLLTDRNLNTSFFDPAGGGDPILYQHLFWFFGHPEVYILILPGFGMISHIISQESGKKETFGSLGMIYAMLAIGLLGFIVWAHHMFTVGMDVDTRAYFTSATMIIAVPTGIKIFSWLATLHGTQLSYSPAILWALGFVFLFTVGGLTGVVLANSSVDIILHDTYYVVAHFHYVLSMGAVFAIMAGFIHWYPLFTGLTLNNKWLKSHFIIMFIGVNLTFFPQHFLGLAGMPRRYSDYPDAYTTWNIVSTIGSTISLLGILFFFFIIWESLVSQRQVIYPIQLNSSIEWYQNTPPAEHSYSELPLLTN",
                                minReadsNum           = 2,
                                minReadLength         = 20,
                                minFractionCall       = 0.5,
                                maxFractionLost       = 0.5,
                                geneticCode           = GENETIC_CODE,
                                acceptStopCodons      = TRUE,
                                readingFrame          = 1,
                                processorsNum         = 1)
```
```{r}
my_sangerContig
```

```{r}
my_sangerContig@objectResults@readResultTable
```

